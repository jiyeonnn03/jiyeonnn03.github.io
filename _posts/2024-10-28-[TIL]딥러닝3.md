---
layout: post
title:  "[TIL] ë”¥ëŸ¬ë‹ 3. RNN"
subtitle:   ""
categories: [TIL] 
tag: [TIL, AI, RNN]
comments: true
---

LG Aimers 5ê¸° AI ì‹¤ìŠµ êµìœ¡ ìˆ˜ê°• ë‚´ìš©ì„ ì •ë¦¬í•©ë‹ˆë‹¤. ëª¨ë“  ìë£ŒëŠ” êµìœ¡ í”Œë«í¼ [ì•¨ë¦¬ìŠ¤](https://elice.io/ko)ë¡œë¶€í„° ì œê³µë°›ì•˜ìŠµë‹ˆë‹¤.

## RNN(Recurrent Neural Network)
**RNNì€ ì‹œê³„ì—´ ë°ì´í„°ì™€ ê°™ì€ ìˆœì°¨ ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•œ ëŒ€í‘œì ì¸ ë”¥ëŸ¬ë‹ ëª¨ë¸**


### 1. ìˆœì°¨ ë°ì´í„°ë€?

**ìˆœì„œ(Order)** ë¥¼ ê°€ì§€ê³  ë‚˜íƒ€ë‚˜ëŠ” ë°ì´í„°
ë°ì´í„° ë‚´ **ê° ê°œì²´ ê°„ ìˆœì„œ**ê°€ ì¤‘ìš”í•¨

![ìˆœì°¨ ë°ì´í„° ì˜ˆì‹œ](https://github.com/user-attachments/assets/ceb3cc48-02ee-401f-9f85-044ece201fa4)

- ì‹œê³„ì—´ ë°ì´í„°(Time-Series)
    - **ì¼ì •í•œ ì‹œê°„ ê°„ê²©**ì„ ê°€ì§€ê³  ì–»ì–´ë‚¸ ë°ì´í„°
    - ì˜ˆ. ì—°ë„ë³„ í‰ê·  ê¸°ì˜¨, ì‹œê°„ë³„ ì£¼ì‹ ê°€ê²© ë“±

- ìì—°ì–´ ë°ì´í„°(Natural Language)
    - ì¸ë¥˜ê°€ ë§í•˜ëŠ” ì–¸ì–´
    - ì£¼ë¡œ ë¬¸ì¥ ë‚´ì—ì„œ **ë‹¨ì–´ê°€ ë“±ì¥í•˜ëŠ” ìˆœì„œ**ì— ì£¼ëª©í•¨

- í™œìš© ë¶„ì•¼
    - ê²½í–¥ì„± íŒŒì•… ex) ì£¼ê°€ ì˜ˆì¸¡, ê¸°ì˜¨ ì˜ˆì¸¡, ê°•ìˆ˜ëŸ‰ ì˜ˆì¸¡ ë“±
    - ìŒì•… ì¥ë¥´ ë¶„ì„(ì˜¤ë””ì˜¤ íŒŒì¼ = ì‹œê³„ì—´)
    - ìŒì„± ì¸ì‹(ìŒì„±ì— í¬í•¨ëœ ë‹¨ì–´, ì†Œë¦¬ ì¶”ì¶œ)
    - ë²ˆì—­ê¸°
    - ì±—ë´‡

### 2. Recurrent Neural Network

**[ ë“±ì¥ ë°°ê²½ ]**   

![](https://github.com/user-attachments/assets/e8559a01-b1fc-4d88-b58a-1c36b9a01ffc)

CNNì—ì„œ ì‚¬ìš©í•˜ëŠ” Fully-connected LayerëŠ” ì…/ì¶œë ¥ ë…¸ë“œ ê°œìˆ˜ê°€ ì •í•´ì ¸ ìˆìŒ   
&rarr; ìˆœì°¨ ë°ì´í„°ëŠ” í•˜ë‚˜ì˜ ë°ì´í„°ë¥¼ ì´ë£¨ëŠ” ê°œì²´ ìˆ˜ê°€ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ(ex. ì„œë¡œ ë‹¤ë¥¸ ê°œìˆ˜ì˜ ë‹¨ì–´ë¡œ êµ¬ì„±ëœ ë¬¸ì¥ë“¤)   
&rarr; FC Layer ì‚¬ìš© ë¶ˆê°€   
&Rightarrow; ìˆœì°¨ ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•œ ëª¨ë¸ ë“±ì¥

**[ í•µì‹¬ êµ¬ì„± ìš”ì†Œ ]**   
- **Hidden State** : ìˆœí™˜ êµ¬ì¡°ë¥¼ êµ¬í˜„í•˜ëŠ” ì¥ì¹˜

**[ ì…ë ¥ ë°ì´í„° êµ¬ì¡° ]**
![](https://github.com/user-attachments/assets/909d5c7e-31d1-4db8-b35e-d09df6665365)

- ê° x<sub>t</sub>ì˜ ì˜ë¯¸
    - ì‹œê³„ì—´ ë°ì´í„° : ì¼ì • ì‹œê°„ ê°„ê²©ìœ¼ë¡œ ë‚˜ëˆ ì§„ ë°ì´í„°ì—ì„œ íŠ¹ì • ì‹œì ì˜ ê°’   
    - ìì—°ì–´ ë°ì´í„° : ë¬¸ì¥ ë‚´ì˜ ê° ë‹¨ì–´


- ì‹œê³„ì—´ ë°ì´í„° ë²¡í„° ë³€í™˜
![](https://github.com/user-attachments/assets/72785d8b-7d49-4485-8bab-354648bc628e)
    - ì…ë ¥ ë°ì´í„°ì˜ ê° x<sub>t</sub>ëŠ” ë²¡í„° í˜•íƒœ
    - ê° ë°ì´í„°ë¥¼ ì´ë£¨ëŠ” Feature ê°’ë“¤ì„ ì›ì†Œë¡œ ë²¡í„° ë³€í™˜
    
- ìì—°ì–´ ë°ì´í„° ë²¡í„° ë³€í™˜
![](https://github.com/user-attachments/assets/6ed2da92-4721-43dd-a2d8-e5a49e68b63d)

    - ì„ë² ë”©(Embedding) ê¸°ë²• : ê° ë‹¨ì–´ë“¤ì„ ìˆ«ì ë²¡í„°ë¡œ ë³€í™˜   
        - One-hot encoding
        - Word2Vec

### 3. Vanilla RNN
- **ê°€ì¥ ê°„ë‹¨í•œ í˜•íƒœì˜ RNN ëª¨ë¸**ì„ ì˜ë¯¸í•¨(Simple RNN)
- ë‚´ë¶€ì— 3ê°œì˜ FC Layerë¡œ êµ¬ì„±   
![](https://github.com/user-attachments/assets/b8ce812f-87cb-42c2-89ef-9478140b1364)
    - ğ‘Š<sub>â„â„</sub>: hidden state(ğ’‰<sub>ğ’•âˆ’ğŸ</sub>)ë¥¼ ë³€í™˜í•˜ëŠ” Layerì˜ ê°€ì¤‘ì¹˜ í–‰ë ¬
    - ğ‘Š<sub>ğ‘¥â„</sub>: í•œ ì‹œì ì˜ ì…ë ¥ê°’(ğ’™<sub>ğ’•</sub>) ì„ ë³€í™˜í•˜ëŠ” Layerì˜ ê°€ì¤‘ì¹˜ í–‰ë ¬
    - ğ‘Š<sub>â„ğ‘¦</sub>: í•œ ì‹œì ì˜ ì¶œë ¥ê°’ (ğ’š<sub>ğ’•</sub>)ì„ ë³€í™˜í•˜ëŠ” Layerì˜ ê°€ì¤‘ì¹˜ í–‰ë ¬

**[ ì—°ì‚° ê³¼ì • ]**
- ëª¨ë¸ì— ë“¤ì–´ì˜¤ëŠ” ê° ì‹œì ì˜ ë°ì´í„° x<sub>t</sub>ë§ˆë‹¤ hidden state, y<sub>t</sub> ë¥¼ ë°˜ë³µì ìœ¼ë¡œ ê³„ì‚°   
![](https://github.com/user-attachments/assets/432c0157-8668-4869-8683-45ccf8681f14)
(ì‹¤ì œë¡œ ì‚¬ìš©ëœ RNN ëª¨ë¸ì€ 1ê°œì´ì§€ë§Œ ìˆœí™˜ êµ¬ì¡°ë¥¼ ë‚˜íƒ€ë‚´ê¸° ìœ„í•´ ê·¸ë¦¼ìƒ ì˜†ìœ¼ë¡œ í¼ì³ë†“ì€ ê²ƒ)



- ğ’‰<sub>ğ’•</sub> ê³„ì‚°   
![](https://github.com/user-attachments/assets/352149ca-199a-4925-967e-00ac4c943400)
    - í˜„ì¬ ì…ë ¥ê°’(ğ’™<sub>ğ’•</sub>)ì— ëŒ€í•œ ìƒˆë¡œìš´ hidden state ê³„ì‚°
    - h<sub>t</sub> = tanh(h<sub>t-1</sub>W<sub>hh</sub> + x<sub>t</sub>W<sub>xh</sub>)
        ![](https://github.com/user-attachments/assets/548411e8-4e05-4d23-9b8a-eefac6c12373)
    (tanhëŠ” tangent hyperbolic í•¨ìˆ˜)

- y<sub>ğ’•</sub> ê³„ì‚°   
![](https://github.com/user-attachments/assets/2624a3ff-cae5-4dcf-94fa-e78eee0ca2ea)
    - í˜„ì¬ ì…ë ¥ê°’(ğ’™<sub>ğ’•</sub>)ì— ëŒ€í•œ ìƒˆë¡œìš´ ì¶œë ¥ê°’ ê³„ì‚°
    - ğ’š<sub>ğ’•</sub> = ğ‘Š<sub>â„ğ‘¦</sub>H<sub>t</sub>
    (ì´ë•Œ ì•ì—ì„œ ê³„ì‚°í•œ hidden stateë¥¼ ì´ìš©)

**[ ì˜ì˜ ]**
- Hidden stateì˜ ì˜ë¯¸
    - íŠ¹ì • ì‹œì  tê¹Œì§€ ë“¤ì–´ì˜¨ ì…ë ¥ê°’ë“¤ì˜ **ìƒê´€ê´€ê³„**ë‚˜ **ê²½í–¥ì„± ì •ë³´**ë¥¼ ì••ì¶•í•´ì„œ ì €ì¥
    &rarr; ëª¨ë¸ì´ ë‚´ë¶€ì ìœ¼ë¡œ ê³„ì† ì—…ë°ì´íŠ¸ í•˜ëŠ” ê°’ìœ¼ë¡œ, ì¼ì¢…ì˜ **ë©”ëª¨ë¦¬**ë¡œ ë³¼ ìˆ˜ ìˆìŒ
- Parameter sharing
    - Hidden stateì™€ ì¶œë ¥ê°’ ê³„ì‚°ì„ ìœ„í•œ FC Layerë¥¼ ëª¨ë“  ì‹œì ì˜ ì…ë ¥ê°’ì´ ì¬ì‚¬ìš©í•¨
    - 3ê°œì˜ FC Layerê°€ ëª¨ë¸ íŒŒë¼ë¯¸í„°ì˜ ì „ë¶€ì¸ êµ¬ì¡°

**[ ì¢…ë¥˜ ]**
- many-to-one : ì—¬ëŸ¬ ì‹œì ì˜ ì…ë ¥ê°’ìœ¼ë¡œ 1ê°œì˜ ì¶œë ¥ê°’ ë„ì¶œ
- many-to-many : ì—¬ëŸ¬ ì‹œì ì˜ ì…ë ¥ê°’, ì—¬ëŸ¬ ì‹œì ì˜ ì¶œë ¥ê°’(ì…/ì¶œë ¥ ê°œìˆ˜ëŠ” ê°™ì„ìˆ˜ë„, ë‹¤ë¥¼ìˆ˜ë„ ìˆìŒ)
- encoder-decoder : ì…ë ¥ê°’ì„ ë°›ì•„ íŠ¹ì • hidden stateë¡œ ì¸ì½”ë”© í›„, hidden stateë¡œë¶€í„° ìƒˆë¡œìš´ ì¶œë ¥ê°’ì„ ë§Œë“œëŠ” êµ¬ì¡°

![ì¢…ë¥˜1](https://github.com/user-attachments/assets/b1e6d067-5b4e-47f4-8270-907ab5343196)
![ì¢…ë¥˜2](https://github.com/user-attachments/assets/36d2973b-53d3-4c37-ba78-a7cd1fd62b0b)


**[ ë¬¸ì œì  ]**

![](https://github.com/user-attachments/assets/8e48dbf5-7119-498e-9c8e-17a9b4e23888)
- ì‹œê°„ ìˆœì„œì— ë”°ë¼ ìƒì„±ë˜ëŠ” ì¶œë ¥ê°’
- ê° ì‹œì ì˜ ì¶œë ¥ê°’ê³¼ ì‹¤ì œê°’ì„ ë¹„êµí•˜ì—¬ ì†ì‹¤(loss)ê°’ì„ ê³„ì‚°í•¨
- ì—­ì „íŒŒ ì•Œê³ ë¦¬ì¦˜ì´ ì‹œê°„ì— ë”°ë¼ ì‘ë™ &rarr; BPTT; Back-propagation Through Time

![](https://github.com/user-attachments/assets/4d0244f9-f93e-4b1c-86b8-5e6297e067e3)
- ì…ë ¥ê°’ì˜ ê¸¸ì´ê°€ ê¸¸ì–´ì§ˆìˆ˜ë¡ ì´ˆê¸° ì…ë ¥ê°’ê³¼ ë‚˜ì¤‘ ì¶œë ¥ê°’ ì‚¬ì´ì— ì „íŒŒë˜ëŠ” ê¸°ìš¸ê¸° ê°’ì´ ë§¤ìš° ì‘ì•„ì§ˆ ê°€ëŠ¥ì„±ì´ ë†’ìŒ   
&rarr; ê¸°ìš¸ê¸° ì†Œì‹¤ ë¬¸ì œ(Vanishing Gradient Problem) ë°œìƒ ê°€ëŠ¥
(=ì¥ê¸° ì˜ì¡´ì„± ë‹¤ë£¨ê¸°ê°€ ì–´ë ¤ì›€)